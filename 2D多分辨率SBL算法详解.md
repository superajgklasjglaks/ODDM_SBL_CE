# 2Då¤šåˆ†è¾¨ç‡ç¨€ç–è´å¶æ–¯å­¦ä¹ (SBL)ç®—æ³•è¯¦è§£

## 1. ç®—æ³•æ¦‚è¿°

2Då¤šåˆ†è¾¨ç‡ç¨€ç–è´å¶æ–¯å­¦ä¹ (2D Multi-Resolution Sparse Bayesian Learning, 2D MR-SBL)æ˜¯ä¸€ç§ç»“åˆäº†äºŒç»´ä¼˜åŒ–å’Œåˆ†å±‚å¤„ç†çš„é«˜æ•ˆä¿¡é“ä¼°è®¡ç®—æ³•ã€‚è¯¥ç®—æ³•é€šè¿‡åœ¨ä¸åŒåˆ†è¾¨ç‡ç½‘æ ¼ä¸Šè¿›è¡Œåˆ†å±‚ä¼°è®¡ï¼Œæ—¢ä¿æŒäº†2D SBLçš„ä¼˜å¼‚æ€§èƒ½ï¼Œåˆæ˜¾è‘—æå‡äº†è®¡ç®—æ•ˆç‡ã€‚

## 2. ç®—æ³•æ ¸å¿ƒæ€æƒ³

### 2.1 å¤šåˆ†è¾¨ç‡ç­–ç•¥

ä¼ ç»Ÿçš„2D SBLç®—æ³•åœ¨é«˜åˆ†è¾¨ç‡ç½‘æ ¼ä¸Šç›´æ¥è¿›è¡Œä¼°è®¡ï¼Œè®¡ç®—å¤æ‚åº¦è¾ƒé«˜ã€‚å¤šåˆ†è¾¨ç‡ç­–ç•¥é‡‡ç”¨"ç²—åˆ°ç»†"çš„åˆ†å±‚å¤„ç†æ–¹æ³•ï¼š

1. **ç²—ç½‘æ ¼ä¼°è®¡**ï¼šåœ¨ä½åˆ†è¾¨ç‡ç½‘æ ¼ä¸Šå¿«é€Ÿè¯†åˆ«ä¿¡é“çš„ä¸»è¦ç‰¹å¾
2. **ç²¾ç»†ç½‘æ ¼ä¼˜åŒ–**ï¼šåœ¨é«˜åˆ†è¾¨ç‡ç½‘æ ¼ä¸Šè¿›è¡Œç²¾ç¡®ä¼°è®¡

### 2.2 äºŒç»´è”åˆä¼˜åŒ–

ä¸1Dåˆ†å±‚ç®—æ³•ä¸åŒï¼Œ2Då¤šåˆ†è¾¨ç‡SBLåŒæ—¶åœ¨å¤šæ™®å‹’åŸŸå’Œæ—¶å»¶åŸŸè¿›è¡Œä¼˜åŒ–ï¼š
- **å¤šæ™®å‹’åŸŸ**ï¼šå¤„ç†ç§»åŠ¨æ€§å¼•èµ·çš„é¢‘ç‡åç§»
- **æ—¶å»¶åŸŸ**ï¼šå¤„ç†å¤šå¾„ä¼ æ’­å¼•èµ·çš„æ—¶å»¶æ‰©å±•

## 3. ç®—æ³•å®ç°æµç¨‹

### 3.1 å‚æ•°è®¾ç½®

```matlab
% ç²—ç½‘æ ¼å‚æ•°
r_v_coarse = 1.0;    % å¤šæ™®å‹’åŸŸç²—åˆ†è¾¨ç‡
r_t_coarse = 1.0;    % æ—¶å»¶åŸŸç²—åˆ†è¾¨ç‡
N_v_coarse = 8;      % ç²—ç½‘æ ¼å¤šæ™®å‹’ç‚¹æ•°
M_t_coarse = 4;      % ç²—ç½‘æ ¼æ—¶å»¶ç‚¹æ•°

% ç²¾ç»†ç½‘æ ¼å‚æ•°
r_v = 0.5;           % å¤šæ™®å‹’åŸŸç²¾ç»†åˆ†è¾¨ç‡
r_t = 0.5;           % æ—¶å»¶åŸŸç²¾ç»†åˆ†è¾¨ç‡
N_v_refined = 16;    % ç²¾ç»†ç½‘æ ¼å¤šæ™®å‹’ç‚¹æ•°
M_t_refined = 8;     % ç²¾ç»†ç½‘æ ¼æ—¶å»¶ç‚¹æ•°
```

### 3.2 ç¬¬ä¸€é˜¶æ®µï¼šç²—ç½‘æ ¼2D SBLä¼°è®¡

```matlab
% ç”Ÿæˆç²—ç½‘æ ¼æµ‹é‡çŸ©é˜µ
[Phi_L_coarse, Phi_R_coarse] = generate_measurement_matrices(r_v_coarse, r_t_coarse);

% æ‰§è¡Œç²—ç½‘æ ¼2D SBL
[H_coarse, k_v_coarse, l_t_coarse] = CE_2D_SBL(Y, Phi_L_coarse, Phi_R_coarse, ...);
```

**ç²—ç½‘æ ¼ä¼°è®¡ç‰¹ç‚¹**ï¼š
- ç½‘æ ¼å¯†åº¦è¾ƒä½ï¼Œè®¡ç®—é€Ÿåº¦å¿«
- èƒ½å¤Ÿå¿«é€Ÿè¯†åˆ«ä¿¡é“çš„ä¸»è¦è·¯å¾„
- ä¸ºç²¾ç»†ä¼°è®¡æä¾›åˆå§‹åŒ–ä¿¡æ¯

### 3.3 ç¬¬äºŒé˜¶æ®µï¼šæ˜¾è‘—ç³»æ•°è¯†åˆ«

```matlab
% è¯†åˆ«æ˜¾è‘—ç³»æ•°
threshold = 0.1 * max(abs(H_coarse(:)));
significant_indices = find(abs(H_coarse) > threshold);

% è½¬æ¢ä¸º2Dç½‘æ ¼ä½ç½®
[row_indices, col_indices] = ind2sub(size(H_coarse), significant_indices);
significant_positions = [row_indices, col_indices];
```

**æ˜¾è‘—ç³»æ•°è¯†åˆ«ç­–ç•¥**ï¼š
- åŸºäºå¹…åº¦é˜ˆå€¼ç­›é€‰é‡è¦ç³»æ•°
- ä¿ç•™ä¿¡é“çš„ä¸»è¦è·¯å¾„ä¿¡æ¯
- ä¸ºç²¾ç»†ç½‘æ ¼åˆ›å»ºæä¾›æŒ‡å¯¼

### 3.4 ç¬¬ä¸‰é˜¶æ®µï¼šç²¾ç»†ç½‘æ ¼åˆ›å»º

```matlab
function [v_grid_refined, t_grid_refined] = create_refined_grid_2D_improved(...)
    % åŸºäºç²¾ç»†åˆ†è¾¨ç‡å‚æ•°åˆ›å»ºå®Œæ•´çš„ç»“æ„åŒ–ç½‘æ ¼
    v_grid_refined = First_Order_Linear_Approximation_2D(r_v, N_v_refined, 'doppler');
    t_grid_refined = First_Order_Linear_Approximation_2D(r_t, M_t_refined, 'delay');
end
```

**ç²¾ç»†ç½‘æ ¼ç‰¹ç‚¹**ï¼š
- åˆ†è¾¨ç‡æ˜¯ç²—ç½‘æ ¼çš„2å€
- è¦†ç›–å®Œæ•´çš„å‚æ•°ç©ºé—´
- æä¾›æ›´é«˜çš„ä¼°è®¡ç²¾åº¦

### 3.5 ç¬¬å››é˜¶æ®µï¼šç²¾ç»†ç½‘æ ¼2D SBLä¼°è®¡

```matlab
% ç²¾ç»†ç½‘æ ¼SBLä¼°è®¡
[H_refined, k_v_refined, l_t_refined] = CE_2D_SBL_refined(...
    Y, v_grid_refined, t_grid_refined, significant_positions, ...);
```

**ç²¾ç»†ä¼°è®¡ç‰¹ç‚¹**ï¼š
- é‡‡ç”¨ä¸åŸå§‹CE_2D_SBLç›¸åŒçš„ç®—æ³•ç»“æ„
- åœ¨é«˜åˆ†è¾¨ç‡ç½‘æ ¼ä¸Šè¿›è¡Œç²¾ç¡®ä¼°è®¡
- è¾“å‡ºæœ€ç»ˆçš„ä¿¡é“ä¼°è®¡ç»“æœ

## 4. ç®—æ³•ä¼˜åŠ¿åˆ†æ

### 4.1 è®¡ç®—æ•ˆç‡æå‡

| é˜¶æ®µ | ç½‘æ ¼è§„æ¨¡ | è®¡ç®—å¤æ‚åº¦ | æ—¶é—´å æ¯” |
|------|----------|------------|----------|
| ç²—ç½‘æ ¼ä¼°è®¡ | 8Ã—4=32ç‚¹ | O(32Ã—M_TÃ—T_max) | ~20% |
| ç²¾ç»†ç½‘æ ¼ä¼°è®¡ | 16Ã—8=128ç‚¹ | O(128Ã—M_TÃ—T_max) | ~80% |
| **æ€»è®¡** | **åˆ†å±‚å¤„ç†** | **æ˜¾è‘—ä½äºç›´æ¥é«˜åˆ†è¾¨ç‡** | **100%** |

### 4.2 ä¼°è®¡ç²¾åº¦ä¿è¯

- **ç²—ç½‘æ ¼**ï¼šå¿«é€Ÿæ”¶æ•›åˆ°ä¿¡é“ä¸»è¦ç‰¹å¾é™„è¿‘
- **ç²¾ç»†ç½‘æ ¼**ï¼šåœ¨é‡è¦åŒºåŸŸè¿›è¡Œé«˜ç²¾åº¦ä¼°è®¡
- **äºŒç»´ä¼˜åŒ–**ï¼šåŒæ—¶ä¼˜åŒ–å¤šæ™®å‹’å’Œæ—¶å»¶å‚æ•°

### 4.3 é²æ£’æ€§å¢å¼º

- **åˆ†å±‚å¤„ç†**ï¼šé™ä½é™·å…¥å±€éƒ¨æœ€ä¼˜çš„é£é™©
- **ç»“æ„åŒ–ç½‘æ ¼**ï¼šä¿è¯ç®—æ³•çš„ç¨³å®šæ€§
- **è‡ªé€‚åº”é˜ˆå€¼**ï¼šæ ¹æ®ä¿¡é“ç‰¹æ€§è°ƒæ•´å‚æ•°

## 5. å…³é”®æŠ€æœ¯ç»†èŠ‚

### 5.1 æµ‹é‡çŸ©é˜µç”Ÿæˆ

```matlab
% å·¦æµ‹é‡çŸ©é˜µï¼ˆå¤šæ™®å‹’åŸŸï¼‰
Phi_L = Gen_measurement_matrix_L(v_grid, pilot_indices, M_T, N_T);

% å³æµ‹é‡çŸ©é˜µï¼ˆæ—¶å»¶åŸŸï¼‰
Phi_R = Gen_measurement_matrix_R(t_grid, pilot_indices, M_T, N_T);
```

### 5.2 SBLè¿­ä»£æ›´æ–°

```matlab
% å‚æ•°æ›´æ–°å¾ªç¯
for iter = 1:Tmax
    % æ›´æ–°å‡å€¼å’Œåæ–¹å·®
    [mu_dc, sigma_dc] = update_posterior_parameters(...);
    
    % æ›´æ–°è¶…å‚æ•°
    alpha_v = update_alpha_v(mu_dc, sigma_dc);
    beta0 = update_beta0(Y, mu_dc, Phi_L, Phi_R);
    
    % æ›´æ–°ç½‘æ ¼å‚æ•°
    k_v = update_k_v(mu_dc, alpha_v, A_v);
    
    % æ”¶æ•›æ£€æŸ¥
    if convergence_check(mu_dc, mu_dc_old)
        break;
    end
end
```

### 5.3 æ”¶æ•›åˆ¤æ®

```matlab
% ç›¸å¯¹å˜åŒ–é‡åˆ¤æ®
relative_change = norm(mu_dc - mu_dc_old, 'fro') / norm(mu_dc_old, 'fro');
if relative_change < tolerance
    converged = true;
end
```

## 6. æ€§èƒ½å¯¹æ¯”åˆ†æ

### 6.1 ä¸1Dåˆ†å±‚ç®—æ³•å¯¹æ¯”

| ç‰¹æ€§ | 1Dåˆ†å±‚SBL | 2Då¤šåˆ†è¾¨ç‡SBL |
|------|-----------|---------------|
| ä¼˜åŒ–ç»´åº¦ | å•ç»´åº¦ï¼ˆæ—¶å»¶æˆ–å¤šæ™®å‹’ï¼‰ | åŒç»´åº¦ï¼ˆæ—¶å»¶+å¤šæ™®å‹’ï¼‰ |
| ä¼°è®¡ç²¾åº¦ | ä¸­ç­‰ | é«˜ |
| è®¡ç®—å¤æ‚åº¦ | ä½ | ä¸­ç­‰ |
| é€‚ç”¨åœºæ™¯ | ä½ç§»åŠ¨æ€§ | é«˜ç§»åŠ¨æ€§ |

### 6.2 ä¸ä¼ ç»Ÿ2D SBLå¯¹æ¯”

| ç‰¹æ€§ | ä¼ ç»Ÿ2D SBL | 2Då¤šåˆ†è¾¨ç‡SBL |
|------|------------|---------------|
| è®¡ç®—é€Ÿåº¦ | æ…¢ | å¿« |
| ä¼°è®¡ç²¾åº¦ | é«˜ | é«˜ |
| å†…å­˜å ç”¨ | å¤§ | ä¸­ç­‰ |
| æ”¶æ•›ç¨³å®šæ€§ | ä¸­ç­‰ | é«˜ |

## 7. åº”ç”¨åœºæ™¯

### 7.1 OTFSç³»ç»Ÿä¿¡é“ä¼°è®¡
- **é«˜ç§»åŠ¨æ€§åœºæ™¯**ï¼šè½¦è”ç½‘ã€é«˜é€Ÿé“è·¯
- **å¤šå¾„ç¯å¢ƒ**ï¼šåŸå¸‚å¯†é›†åŒºåŸŸã€å®¤å†…ç¯å¢ƒ
- **å®æ—¶æ€§è¦æ±‚**ï¼šéœ€è¦å¿«é€Ÿå‡†ç¡®çš„ä¿¡é“ä¼°è®¡

### 7.2 æ¯«ç±³æ³¢é€šä¿¡
- **å¤§è§„æ¨¡MIMO**ï¼šéœ€è¦é«˜ç²¾åº¦çš„ä¿¡é“çŠ¶æ€ä¿¡æ¯
- **æ³¢æŸæˆå½¢**ï¼šè¦æ±‚ç²¾ç¡®çš„è§’åº¦åŸŸä¿¡æ¯
- **åŠŸç‡å—é™**ï¼šéœ€è¦é«˜æ•ˆçš„ç®—æ³•å®ç°

## 8. å‚æ•°è°ƒä¼˜æŒ‡å—

### 8.1 åˆ†è¾¨ç‡å‚æ•°é€‰æ‹©

```matlab
% æ¨èå‚æ•°è®¾ç½®
r_v_coarse = 1.0~1.5;  % ç²—ç½‘æ ¼å¤šæ™®å‹’åˆ†è¾¨ç‡
r_t_coarse = 1.0~1.5;  % ç²—ç½‘æ ¼æ—¶å»¶åˆ†è¾¨ç‡
r_v = 0.5~0.8;         % ç²¾ç»†ç½‘æ ¼å¤šæ™®å‹’åˆ†è¾¨ç‡
r_t = 0.5~0.8;         % ç²¾ç»†ç½‘æ ¼æ—¶å»¶åˆ†è¾¨ç‡
```

### 8.2 è¿­ä»£å‚æ•°è°ƒæ•´

```matlab
% è¿­ä»£æ§åˆ¶å‚æ•°
Tmax_coarse = 50;      % ç²—ç½‘æ ¼æœ€å¤§è¿­ä»£æ¬¡æ•°
Tmax_refined = 100;    % ç²¾ç»†ç½‘æ ¼æœ€å¤§è¿­ä»£æ¬¡æ•°
tolerance = 1e-4;      % æ”¶æ•›å®¹å·®
```

### 8.3 é˜ˆå€¼å‚æ•°è®¾ç½®

```matlab
% æ˜¾è‘—ç³»æ•°è¯†åˆ«é˜ˆå€¼
threshold_ratio = 0.1;  % ç›¸å¯¹é˜ˆå€¼æ¯”ä¾‹
min_threshold = 1e-3;   % æœ€å°ç»å¯¹é˜ˆå€¼
```

## 9. å®ç°æ³¨æ„äº‹é¡¹

### 9.1 æ•°å€¼ç¨³å®šæ€§
- çŸ©é˜µæ±‚é€†æ—¶æ£€æŸ¥æ¡ä»¶æ•°
- ä½¿ç”¨æ­£åˆ™åŒ–é¿å…å¥‡å¼‚çŸ©é˜µ
- åˆç†è®¾ç½®åˆå§‹åŒ–å‚æ•°

### 9.2 å†…å­˜ç®¡ç†
- åŠæ—¶é‡Šæ”¾ä¸­é—´å˜é‡
- ä½¿ç”¨ç¨€ç–çŸ©é˜µå­˜å‚¨
- åˆ†å—å¤„ç†å¤§è§„æ¨¡é—®é¢˜

### 9.3 å¹¶è¡ŒåŒ–ä¼˜åŒ–
- CE_Algo1è°ƒç”¨å¯å¹¶è¡Œæ‰§è¡Œ
- çŸ©é˜µè¿ç®—åˆ©ç”¨å¤šæ ¸å¤„ç†
- GPUåŠ é€Ÿå¤§è§„æ¨¡è®¡ç®—

## 10. æ€»ç»“

2Då¤šåˆ†è¾¨ç‡SBLç®—æ³•é€šè¿‡å·§å¦™ç»“åˆåˆ†å±‚å¤„ç†å’ŒäºŒç»´ä¼˜åŒ–ï¼Œåœ¨ä¿æŒé«˜ä¼°è®¡ç²¾åº¦çš„åŒæ—¶æ˜¾è‘—æå‡äº†è®¡ç®—æ•ˆç‡ã€‚è¯¥ç®—æ³•ç‰¹åˆ«é€‚ç”¨äºé«˜ç§»åŠ¨æ€§çš„OTFSç³»ç»Ÿä¿¡é“ä¼°è®¡ï¼Œä¸ºä¸‹ä¸€ä»£æ— çº¿é€šä¿¡ç³»ç»Ÿæä¾›äº†æœ‰æ•ˆçš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆã€‚

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… è®¡ç®—æ•ˆç‡é«˜ï¼šåˆ†å±‚å¤„ç†å‡å°‘è®¡ç®—é‡
- âœ… ä¼°è®¡ç²¾åº¦é«˜ï¼šäºŒç»´è”åˆä¼˜åŒ–
- âœ… é²æ£’æ€§å¼ºï¼šç»“æ„åŒ–ç½‘æ ¼è®¾è®¡
- âœ… é€‚åº”æ€§å¥½ï¼šå‚æ•°å¯è°ƒèŠ‚

**åº”ç”¨å‰æ™¯**ï¼š
- ğŸš— è½¦è”ç½‘é€šä¿¡
- ğŸš„ é«˜é€Ÿç§»åŠ¨é€šä¿¡
- ğŸ“¡ æ¯«ç±³æ³¢ç³»ç»Ÿ
- ğŸ¢ å¤§è§„æ¨¡MIMO